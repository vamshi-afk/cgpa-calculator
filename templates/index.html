<!DOCTYPE html>
<html>
<head>
    <title>SGPA Calculator</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

<div class="container mt-4">

    <h2 class="mb-3">SGPA Calculator</h2>

<div class="d-flex justify-content-between align-items-center mb-3">

    <h5 class="mb-0">Number of Subjects</h5>

    <div class="btn-group" role="group">

        <input type="radio" class="btn-check" name="subcount" id="sub5" onclick="generateSubjects(5)">
        <label class="btn btn-outline-primary rounded-circle px-3" for="sub5">5</label>

        <input type="radio" class="btn-check" name="subcount" id="sub6" onclick="generateSubjects(6)">
        <label class="btn btn-outline-primary rounded-circle px-3" for="sub6">6</label>

        <input type="radio" class="btn-check" name="subcount" id="sub7" onclick="generateSubjects(7)">
        <label class="btn btn-outline-primary rounded-circle px-3" for="sub7">7</label>

        <input type="radio" class="btn-check" name="subcount" id="sub8" onclick="generateSubjects(8)">
        <label class="btn btn-outline-primary rounded-circle px-3" for="sub8">8</label>

    </div>

</div>

    <form method="POST" action="/sgpa">

        <div id="subjects"></div>

        <button type="submit" class="btn btn-primary mt-3">
            Calculate SGPA
        </button>

    </form>

    {% if sgpa is not none %}
        <div class="alert alert-success mt-4">
            <h4>SGPA: {{ sgpa }}</h4>
        </div>
    {% endif %}

    {% if old_credits %}
<script>
    const count = {{ old_credits|length }};
    const radio = document.getElementById("sub" + count);
    if (radio) {
        radio.checked = true;
    }
</script>
{% endif %}


</div>

<script>
function generateSubjects(count, oldCredits = [], oldGrades = []) {
    const container = document.getElementById("subjects");
    container.innerHTML = "";

    for (let i = 0; i < count; i++) {

        const creditVal = oldCredits[i] || "";
        const gradeVal = oldGrades[i] || "S";

        const row = document.createElement("div");
        row.className = "row g-2 mb-2";

        row.innerHTML = `
            <div class="col-md-6">
                <input type="number" step="0.5" name="credits" class="form-control"
                       placeholder="Credits for Subject ${i+1}" value="${creditVal}" required>
            </div>

            <div class="col-md-6">
                <select name="grade" class="form-select">
                    ${["S","A+","A","B+","B","C","D","E","NC"].map(g =>
                        `<option ${g===gradeVal?"selected":""}>${g}</option>`
                    ).join("")}
                </select>
            </div>
        `;

        container.appendChild(row);
    }
}
</script>

</body>
</html>

