<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>GPA Toolkit</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>

<body class="bg-light">

<div class="container mt-4">

<h2 class="text-center mb-4">GPA Toolkit</h2>

<!-- Tabs -->
<ul class="nav nav-tabs mb-3" id="gpaTabs" role="tablist">

  <li class="nav-item">
    <button class="nav-link active" id="sgpa-tab"
            data-bs-toggle="tab" data-bs-target="#sgpa">
      SGPA Calculator
    </button>
  </li>

  <li class="nav-item">
    <button class="nav-link" id="estimator-tab"
            data-bs-toggle="tab" data-bs-target="#estimator">
      CGPA Estimator
    </button>
  </li>

  <li class="nav-item">
    <button class="nav-link" id="finder-tab"
            data-bs-toggle="tab" data-bs-target="#finder">
      SGPA Finder
    </button>
  </li>

</ul>

<div class="tab-content bg-white p-4 border rounded shadow">

<!-- ================= SGPA TAB ================= -->
<div class="tab-pane fade show active" id="sgpa">

<form method="POST" action="/sgpa">

<div class="d-flex justify-content-between align-items-center mb-3">
  <h5 class="mb-0">Number of Subjects</h5>

  <div class="btn-group">
    {% for n in range(5,9) %}
      <input type="radio" class="btn-check" id="sub{{n}}"
             onclick="generateSubjects({{n}})">
      <label class="btn btn-outline-primary rounded-circle px-3"
             for="sub{{n}}">{{n}}</label>
    {% endfor %}
  </div>
</div>

<div id="subjects"></div>

<button class="btn btn-primary mt-3">Calculate SGPA</button>

</form>

{% if sgpa is not none %}
<div class="alert alert-success mt-3">
  <h4>SGPA: {{ sgpa }}</h4>
</div>
{% endif %}

</div>

<!-- ================= ESTIMATOR TAB ================= -->
<div class="tab-pane fade" id="estimator">

<form method="POST" action="/estimator">

<div class="mb-3">
<label>Current CGPA</label>
<input type="number" step="0.01" name="current_cgpa" class="form-control" required>
</div>

<div class="mb-3">
<label>Total Credits Completed</label>
<input type="number" step="0.5" name="current_credits" class="form-control" required>
</div>

<div class="mb-3">
<label>Credits This Semester</label>
<input type="number" step="0.5" name="sem_credits" class="form-control" required>
</div>

<div class="mb-3">
<label>Target CGPA</label>
<input type="number" step="0.01" name="target_cgpa" class="form-control" required>
</div>

<button class="btn btn-success">Calculate Required SGPA</button>

</form>

{% if required_sgpa is not none %}
<div class="alert alert-info mt-3">
<h4>Required SGPA: {{ required_sgpa }}</h4>
<p>{{ message }}</p>
</div>
{% endif %}

</div>

<!-- ================= FINDER TAB ================= -->
<div class="tab-pane fade" id="finder">

<form method="POST" action="/finder">

<div class="mb-3">
<label>Previous CGPA</label>
<input type="number" step="0.01" name="prev_cgpa" class="form-control" required>
</div>

<div class="mb-3">
<label>Previous Total Credits</label>
<input type="number" step="0.5" name="prev_credits" class="form-control" required>
</div>

<div class="mb-3">
<label>New CGPA</label>
<input type="number" step="0.01" name="new_cgpa" class="form-control" required>
</div>

<div class="mb-3">
<label>Credits This Semester</label>
<input type="number" step="0.5" name="sem_credits" class="form-control" required>
</div>

<button class="btn btn-warning">Find SGPA</button>

</form>

{% if sgpa is not none and required_sgpa is none %}
<div class="alert alert-success mt-3">
<h4>Semester SGPA: {{ sgpa }}</h4>
</div>
{% endif %}

</div>

</div>
</div>

<script>
function generateSubjects(count, oldCredits=[], oldGrades=[]) {
    const container = document.getElementById("subjects");
    container.innerHTML = "";

    const gradesList = ["S","A+","A","B+","B","C","D","E","NC"];

    for (let i=0;i<count;i++) {
        const creditVal = oldCredits[i] || "";
        const gradeVal = oldGrades[i] || "S";

        const row = document.createElement("div");
        row.className = "row g-2 mb-2";

        row.innerHTML = `
            <div class="col-md-6">
                <input type="number" step="0.5" name="credits"
                       class="form-control"
                       placeholder="Credits Subject ${i+1}"
                       value="${creditVal}" required>
            </div>

            <div class="col-md-6">
                <select name="grade" class="form-select">
                    ${gradesList.map(g =>
                        `<option ${g===gradeVal?"selected":""}>${g}</option>`
                    ).join("")}
                </select>
            </div>
        `;
        container.appendChild(row);
    }
}
</script>

</body>
</html>

